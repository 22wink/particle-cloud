<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <title>æ‰‹åŠ¿æ˜Ÿäº‘çˆ±å¿ƒ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’•</text></svg>" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="overlay">
      <!-- <div class="title">æ‰‹åŠ¿ç²’å­çˆ±å¿ƒ</div> -->
      <div class="hint">å¼ å¼€æ‰‹æŒï¼šæ”¾å¤§æˆæ˜Ÿäº‘ Â· æåˆæ‰‹æŒï¼šçˆ±å¿ƒæ”¶ç¼©</div>
      <div class="status" id="status">ç­‰å¾…æ‘„åƒå¤´æˆæƒ...</div>
    </div>
    <video id="video" autoplay playsinline muted></video>
    <div id="webgl-container"></div>
    <script>
      // è®¾ç½® MediaPipe èµ„æºè·¯å¾„ï¼ˆå¿…é¡»åœ¨æ‰€æœ‰ MediaPipe è„šæœ¬ä¹‹å‰ï¼‰
      // ç¡®ä¿åœ¨å…¨å±€ä½œç”¨åŸŸä¸­è®¾ç½®ï¼Œè®©æ‰€æœ‰è„šæœ¬éƒ½èƒ½è®¿é—®
      (function() {
        // è·å–åŸºç¡€è·¯å¾„ï¼ˆå¤„ç† GitHub Pages å­è·¯å¾„ï¼‰
        var pathname = window.location.pathname;
        var lastSlash = pathname.lastIndexOf('/');
        var basePath = lastSlash >= 0 ? pathname.substring(0, lastSlash + 1) : '/';
        
        // ç¡®ä¿ Module å¯¹è±¡åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å­˜åœ¨ï¼ˆä½¿ç”¨ window.Module ç¡®ä¿å…¨å±€è®¿é—®ï¼‰
        if (typeof window.Module === 'undefined') {
          window.Module = {};
        }
        // åŒæ—¶è®¾ç½® Moduleï¼ˆæŸäº›è„šæœ¬å¯èƒ½ç›´æ¥è®¿é—® Moduleï¼‰
        if (typeof Module === 'undefined') {
          Module = window.Module;
        }
        
        // è®¾ç½® locateFile å‡½æ•°ï¼Œç¡®ä¿èµ„æºæ–‡ä»¶è·¯å¾„æ­£ç¡®
        // è¿™ä¸ªå‡½æ•°ä¼šè¢« hands_solution_packed_assets_loader.js è°ƒç”¨
        var locateFileFunc = function(file, prefix) {
          // å¦‚æœæ–‡ä»¶å·²ç»åœ¨ libs/mediapipe/ è·¯å¾„ä¸­ï¼Œç›´æ¥ä½¿ç”¨
          if (file.indexOf('libs/mediapipe/') === 0) {
            return basePath + file;
          }
          // å¦åˆ™æ·»åŠ  libs/mediapipe/ å‰ç¼€
          var fullPath = basePath + 'libs/mediapipe/' + file;
          console.log('[MediaPipe] locateFile called:', file, 'prefix:', prefix, '->', fullPath);
          return fullPath;
        };
        
        // åŒæ—¶è®¾ç½®åˆ° window.Module å’Œ Module
        window.Module.locateFile = locateFileFunc;
        Module.locateFile = locateFileFunc;
        
        // è®¾ç½® locateFilePackageï¼ˆæ—§ç‰ˆæœ¬å…¼å®¹ï¼‰
        window.Module.locateFilePackage = locateFileFunc;
        Module.locateFilePackage = locateFileFunc;
        
        console.log('[MediaPipe] Module.locateFile configured, basePath:', basePath);
        console.log('[MediaPipe] Module.locateFile function:', typeof Module.locateFile);
      })();
    </script>
    <script src="./libs/mediapipe/camera_utils.js"></script>
    <script src="./libs/mediapipe/hands.js"></script>
    <script src="./libs/mediapipe/hands_solution_packed_assets_loader.js"></script>
    <script src="./libs/mediapipe/hands_solution_simd_wasm_bin.js"></script>
    <script type="module" src="./main.js"></script>
  </body>
</html>

